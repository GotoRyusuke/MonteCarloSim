# 蒙特卡洛模拟法估计实物期权波动率
-------------------------------
## Intro
有几位朋友在微博上问到我这个怎么做，于是就尝试了一下，希望能够抛砖引玉、给需要的朋友提供参考。项目目的是使用蒙特卡洛模拟法测算实物期权的波动率。思路如下：
1. 给定净利润（*netRev*）、固定资产折旧(*deprFA*)、无形资产摊销(*amorIA*)的时间序列数据，拟合三个变量的分布（目前只支持均匀分布和高斯分布）；
2. 自动选取各个变量的最优分布；
3. 给定模拟次数（*N*）、期数(*T*)，基于第2步得到的最优分布为三个变量生成随机序列；；
4. 基于已测算好的加权平均资本成本（*WACC*），计算自由现金流(*FCF*)折现值(*NPV*)；
5. 基于*N*个自由现金流现值，计算波动率（*sigma*）

相关公式如下：

$$ FCF_t = netRev_t + deprFA_t + amorIA_t 
$$

$$
FCF^{NPV} = \sum^T_{t=1} \frac{FCF_t}{(1+r)^t}
$$

$$
\sigma = \frac{
 \sqrt{Var(FCF^{NPV})}
 }{Mean(FCF^{NPV})\times \sqrt{t}}
$$

参考文献：

[1]徐嘉甜.(2022).基于改进的实物期权法的医疗器械企业价值评估研究(硕士学位论文,东北财经大学).

## Structure
主要函数和类均在[`utils.py`](./utils.py)中，已经写了较为详细的说明，请直接参考用法。使用案例请下载[该文件](./MonteCarloSim_Volatility.html)查看完整流程；若希望在使用案例的基础上进行尝试，请下载对应[Jupyter Notebook](MonteCarloSim_Volatility.ipynb)。使用案例中使用到的数据见[示例数据](./data.xlsx)。`module_info`中是模组相关信息，主要有关模组结构和作者信息。

## Issues & Further...
起初没有想写得很复杂、要对标水晶球之类的，所以目前只支持拟合均匀分布和高斯分布并基于最优分布生成这两种分布的样本。demo的时候有尝试对数正态和beta分布等更复杂的分布，但效果一般，有兴趣改进的朋友请联系我或直接pull上来，我看到会处理。若使用中有任何问题，可直接通过首页信息联系本人。感谢您对开源社区的贡献。
